name: Prod deploy

# Controls when the action will run.
on:
  # Triggers the workflow on push or pull request events but only for the master branch
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
        - name: Set up
          working-directory : remix
          run: |
            git config user.name "Action"
            git config user.email "actions@github.com"

        - name: Checkout Code
          uses: actions/checkout@v3

        - name: cache node
          uses: actions/cache@v3
          with:
            path: ~/.npm
            key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
            restore-keys: |
               ${{ runner.os}}-node-

        - name : npm install
          working-directory : remix
          run : npm install

        - name : npm build
          working-directory : remix
          run : npm run build

        - name: ðŸ“‚ Deploy to Server
          run : |
            cd remix
            npm run deploy